{"ast":null,"code":"import _asyncToGenerator from \"/home/fernando/Documents/tarea/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nexport class LoginService {\n  constructor(route, http) {\n    this.route = route;\n    this.http = http;\n    this.Usuario = '';\n    this.Contrasena = '';\n    this.usuarios = [];\n  }\n\n  Validacion(usuario, contrasena) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield localStorage.setItem(\"usuarioactivo\", \"\");\n      yield localStorage.setItem(\"localactivo\", \"\");\n      yield localStorage.setItem(\"adminactivo\", \"\");\n      yield _this.validarusuario(usuario, contrasena);\n\n      if (yield _this.validarusuario(usuario, contrasena)) {\n        return true;\n      }\n\n      if (yield _this.validarlocal(usuario, contrasena)) {\n        return true;\n      }\n\n      if ((yield usuario) == 'admin' && contrasena == '123') {\n        localStorage.setItem(\"adminactivo\", \"1\");\n        return true;\n      } else {\n        return false;\n      }\n    })();\n  }\n\n  validarusuario(usuario, contrasena) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      let usuarioact = 0;\n      yield _this2.http.get('http://127.0.0.1:8080/api/usuariologin' + \"/\" + usuario + \"/\" + contrasena).toPromise().then(resp => {\n        if (resp != null) {\n          usuarioact = resp;\n          localStorage.setItem(\"usuarioactivo\", resp.toString());\n        }\n\n        ;\n      });\n\n      if (usuarioact == 0) {\n        return false;\n      } else {\n        _this2.http.get('http://localhost:8080/api/reservacarrito/' + localStorage.getItem(\"usuarioactivo\")).toPromise().then(resp => localStorage.setItem(\"carrito\", usuarioact.toString()));\n\n        return true;\n      }\n    })();\n  }\n\n  validarlocal(usuario, contrasena) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      let localact = 0;\n      yield _this3.http.get('http://127.0.0.1:8080/api/locallogin' + \"/\" + usuario + \"/\" + contrasena).toPromise().then(resp => {\n        if (resp != null) {\n          localact = resp;\n          localStorage.setItem(\"localactivo\", resp.toString());\n        }\n\n        ;\n      });\n\n      if (localact == 0) {\n        return false;\n      } else {\n        return true;\n      }\n    })();\n  }\n\n  ingresar() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      if (yield _this4.Validacion(_this4.Usuario, _this4.Contrasena)) {\n        _this4.route.navigate(['categorias']);\n      } else {\n        alert('Invalido el usuario y contraseña');\n      }\n    })();\n  }\n\n}\n\nLoginService.ɵfac = function LoginService_Factory(t) {\n  return new (t || LoginService)(i0.ɵɵinject(i1.Router), i0.ɵɵinject(i2.HttpClient));\n};\n\nLoginService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: LoginService,\n  factory: LoginService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/home/fernando/Documents/tarea/src/app/login/login-main/services/login.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Usuario} from 'src/app/modelo/usuario.class';\r\nimport { Router } from '@angular/router';\r\nimport { Local } from '../../../modelo/local.class';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { HeaderComponent } from '../../../common-vista/header/header.component';\r\n\r\n\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class LoginService {\r\n\r\n  constructor(private route:Router,private http:HttpClient) { }\r\n  Usuario:string=''\r\n  Contrasena:string=''\r\n  usuarios:Usuario[]=[]\r\n  \r\n\r\n  async Validacion(usuario:string,contrasena:string):Promise<Boolean>{\r\n    await localStorage.setItem(\"usuarioactivo\",\"\")\r\n    await localStorage.setItem(\"localactivo\",\"\")\r\n    await localStorage.setItem(\"adminactivo\",\"\")\r\n    await this.validarusuario(usuario,contrasena)\r\n\r\n\r\n    if (await this.validarusuario(usuario,contrasena) ){\r\n      return true\r\n    }\r\n    if (await this.validarlocal(usuario,contrasena)) {\r\n      return true\r\n    }\r\n    if(await usuario=='admin' && contrasena=='123') {\r\n      localStorage.setItem(\"adminactivo\",\"1\")\r\n      return true\r\n    }\r\n    else{\r\n      return false\r\n    }\r\n\r\n}\r\n  async validarusuario(usuario:string,contrasena:string):Promise<Boolean>{\r\n    let usuarioact:Number=0\r\n    await this.http.get<number>('http://127.0.0.1:8080/api/usuariologin'+\"/\"+usuario+\"/\"+contrasena).toPromise().then(((resp:number)=>{if (resp!=null){usuarioact=resp ;localStorage.setItem(\"usuarioactivo\",resp.toString());};}));\r\n    if (usuarioact==0){\r\n      return false\r\n    }\r\n    else{\r\n      this.http.get<number>('http://localhost:8080/api/reservacarrito/'+localStorage.getItem(\"usuarioactivo\")).toPromise().then((resp:Number)=>localStorage.setItem(\"carrito\",usuarioact.toString())); \r\n    return true}\r\n    }\r\n    async validarlocal(usuario:string,contrasena:string):Promise<Boolean>{\r\n      let localact:number=0\r\n      await this.http.get<number>('http://127.0.0.1:8080/api/locallogin'+\"/\"+usuario+\"/\"+contrasena).toPromise().then((resp:number)=>{if (resp!=null){localact=resp;localStorage.setItem(\"localactivo\",resp.toString());};});\r\n      if (localact==0){\r\n        return false\r\n      }\r\n      else{\r\n      return true}\r\n      }\r\n\r\n  async ingresar(){\r\n    if(await this.Validacion(this.Usuario,this.Contrasena)){\r\n      this.route.navigate(['categorias'])\r\n    }\r\n    else{\r\n      alert('Invalido el usuario y contraseña')\r\n    }\r\n  }\r\n}\r\n\r\n\r\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}